開始檢查資料庫...
Python ODBC 驅動程式列表:
['SQL Server', 'SQL Server Native Client RDA 11.0', 'ODBC Driver 17 for SQL Server', 'Microsoft Access Driver (*.mdb, *.accdb)', 'Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)', 'Microsoft Access Text Driver (*.txt, *.csv)', 'Microsoft Access dBASE Driver (*.dbf, *.ndx, *.mdx)']
嘗試連接資料庫...
連接字串: DRIVER={SQL Server};SERVER=LAPTOP-QJNCMBU4;DATABASE=FlightBookingDB;UID=sa;PWD=Id1001624;Trusted_Connection=yes;
資料庫連接成功！

航空公司數量: 9

航空公司資料:
資料表欄位: ['airline_id', 'airline_name_en', 'airline_name_zh', 'contact_info', 'url', 'is_domestic', 'created_at', 'updated_at']

前5筆航空公司資料:
('AE', 'Mandarin Airlines', '華信航空', '+886-2-2717-1230', 'https://www.mandarin-airlines.com/', True, '2025-03-19 00:00:00.0000000', '2025-03-19 00:00:00.0000000')
('B7', 'UNI Air', '立榮航空', '+886-2-2518-5166', 'https://www.uniair.com.tw/', True, '2025-03-19 00:00:00.0000000', '2025-03-19 00:00:00.0000000')
('BR', 'EVA Air', '長榮航空', '+886-2-2501-1999', 'https://www.evaair.com/', True, '2025-03-19 00:00:00.0000000', '2025-03-19 00:00:00.0000000')
('CI', 'China Airlines', '中華航空', '+886-2-412-9000', 'https://www.china-airlines.com/', True, '2025-03-19 00:00:00.0000000', '2025-03-19 00:00:00.0000000')
('CX', 'Cathay Pacific', '國泰航空', '+852-2747-3333', 'https://www.cathaypacific.com/', False, '2025-03-19 00:00:00.0000000', '2025-03-19 00:00:00.0000000')
資料庫連接已關閉
嘗試連接資料庫...
連接字串: DRIVER={SQL Server};SERVER=LAPTOP-QJNCMBU4;DATABASE=FlightBookingDB;UID=sa;PWD=Id1001624;Trusted_Connection=yes;
資料庫連接成功！

航班總數: 304

航班表結構:
flight_number: varchar
scheduled_departure: datetime2
airline_id: varchar
departure_airport_code: varchar
arrival_airport_code: varchar
scheduled_arrival: datetime2
flight_status: varchar
aircraft_type: varchar
price: decimal
booking_link: varchar
created_at: datetime2
updated_at: datetime2
scrape_date: datetime2

最近5筆航班資料:
資料表欄位: ['flight_number', 'scheduled_departure', 'airline_id', 'departure_airport_code', 'arrival_airport_code', 'scheduled_arrival', 'flight_status', 'aircraft_type', 'price', 'booking_link', 'created_at', 'updated_at', 'scrape_date']
('7001', '2025-03-21 08:00:00.0000000', 'DA', 'KHH', 'CMJ', '2025-03-21 08:40:00.0000000', None, 'ATR72-600', None, None, '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:55.9930830')
('7002', '2025-03-21 09:10:00.0000000', 'DA', 'CMJ', 'KHH', '2025-03-21 09:50:00.0000000', None, 'ATR72-600', None, None, '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:55.9930830')
('7005', '2025-03-21 10:20:00.0000000', 'DA', 'KHH', 'WOT', '2025-03-21 11:05:00.0000000', None, 'ATR72-600', None, None, '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:55.9930830')
('7006', '2025-03-21 11:35:00.0000000', 'DA', 'WOT', 'KHH', '2025-03-21 12:20:00.0000000', None, 'ATR72-600', None, None, '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:55.9930830')
('7009', '2025-03-21 10:30:00.0000000', 'DA', 'KHH', 'CMJ', '2025-03-21 11:10:00.0000000', None, 'ATR72-600', None, None, '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:56.1000000', '2025-03-21 15:37:55.9930830')

檢查特定路線 (TPE -> HKG):
台北到香港的航班數量: 24
路線航班詳情:
('AE183', '2025-03-25 17:15:00.0000000', 'AE', 'TPE', 'HKG', '2025-03-25 19:59:55.4366667', 'on_time', 'A333', Decimal('8356.00'), 'https://example.com/book/AE183', '2025-03-22 01:06:54.2700000', '2025-03-22 01:06:54.2700000', '2025-03-22 01:06:54.2733333')
('AE388', '2025-03-22 08:45:00.0000000', 'AE', 'TPE', 'HKG', '2025-03-22 13:40:35.1666667', 'on_time', 'B789', Decimal('12420.00'), 'https://example.com/book/AE388', '2025-03-22 01:47:34.0466667', '2025-03-22 01:47:34.0466667', '2025-03-22 01:47:34.0366667')
('AE605', '2025-03-22 14:30:00.0000000', 'AE', 'TPE', 'HKG', '2025-03-22 17:34:01.1266667', 'on_time', 'A333', Decimal('5181.00'), 'https://example.com/book/AE605', '2025-03-22 01:47:34.1900000', '2025-03-22 01:47:34.1900000', '2025-03-22 01:47:34.1766667')
('AE932', '2025-03-29 15:30:00.0000000', 'AE', 'TPE', 'HKG', '2025-03-29 20:31:25.8833333', 'on_time', 'A320', Decimal('4779.00'), 'https://example.com/book/AE932', '2025-03-22 01:07:39.9733333', '2025-03-22 01:07:39.9733333', '2025-03-22 01:07:39.9766667')
('B7187', '2025-03-22 14:45:00.0000000', 'B7', 'TPE', 'HKG', '2025-03-22 17:20:32.3966667', 'on_time', 'B789', Decimal('3840.00'), 'https://example.com/book/B7187', '2025-03-22 07:35:10.9200000', '2025-03-22 07:35:10.9200000', '2025-03-22 07:35:10.9100000')
('B7300', '2025-03-23 07:45:00.0000000', 'B7', 'TPE', 'HKG', '2025-03-23 13:07:07.2000000', 'on_time', 'B77W', Decimal('3052.00'), 'https://example.com/book/B7300', '2025-03-22 00:52:21.5200000', '2025-03-22 00:52:21.5200000', '2025-03-22 00:52:21.5266667')
('B7634', '2025-03-28 06:45:00.0000000', 'B7', 'TPE', 'HKG', '2025-03-28 08:53:52.9500000', 'delayed', 'B789', Decimal('13474.00'), 'https://example.com/book/B7634', '2025-03-22 01:07:24.9466667', '2025-03-22 01:07:24.9466667', '2025-03-22 01:07:24.9500000')
('BR157', '2025-03-22 14:15:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-22 17:34:15.7566667', 'on_time', 'B738', Decimal('6451.00'), 'https://example.com/book/BR157', '2025-03-22 11:39:38.8100000', '2025-03-22 11:39:38.8100000', '2025-03-22 11:39:38.7866667')
('BR738', '2025-03-27 18:45:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-27 23:12:08.7366667', 'on_time', 'B738', Decimal('9738.00'), 'https://example.com/book/BR738', '2025-03-22 01:07:21.2966667', '2025-03-22 01:07:21.2966667', '2025-03-22 01:07:21.3000000')
('BR744', '2025-03-22 12:45:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-22 14:48:01.9066667', 'on_time', 'B789', Decimal('6499.00'), 'https://example.com/book/BR744', '2025-03-22 07:35:10.7400000', '2025-03-22 07:35:10.7400000', '2025-03-22 07:35:10.7233333')
('BR749', '2025-03-26 13:00:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-26 17:34:21.3833333', 'on_time', 'B789', Decimal('8451.00'), 'https://example.com/book/BR749', '2025-03-22 01:07:11.9700000', '2025-03-22 01:07:11.9700000', '2025-03-22 01:07:11.9700000')
('BR753', '2025-03-29 17:15:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-29 21:16:21.5266667', 'on_time', 'B77W', Decimal('6559.00'), 'https://example.com/book/BR753', '2025-03-22 01:07:40.2133333', '2025-03-22 01:07:40.2133333', '2025-03-22 01:07:40.2166667')
('BR998', '2025-03-22 14:15:00.0000000', 'BR', 'TPE', 'HKG', '2025-03-22 19:40:33.0666667', 'on_time', 'B738', Decimal('11851.00'), 'https://example.com/book/BR998', '2025-03-22 00:51:43.5266667', '2025-03-22 00:51:43.5266667', '2025-03-22 00:51:43.5433333')
('CI202', '2025-03-23 06:30:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-23 11:12:42.0300000', 'delayed', 'B77W', Decimal('8211.00'), 'https://example.com/book/CI202', '2025-03-22 00:52:21.1766667', '2025-03-22 00:52:21.1766667', '2025-03-22 00:52:21.1866667')
('CI375', '2025-03-27 15:15:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-27 20:27:50.2600000', 'on_time', 'B77W', Decimal('2354.00'), 'https://example.com/book/CI375', '2025-03-22 01:07:21.0100000', '2025-03-22 01:07:21.0100000', '2025-03-22 01:07:21.0133333')
('CI404', '2025-03-22 17:15:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-22 22:23:35.9166667', 'on_time', 'B77W', Decimal('2293.00'), 'https://example.com/book/CI404', '2025-03-22 00:51:43.6866667', '2025-03-22 00:51:43.6866667', '2025-03-22 00:51:43.7000000')
('CI582', '2025-03-28 06:15:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-28 10:08:03.5300000', 'on_time', 'B738', Decimal('6500.00'), 'https://example.com/book/CI582', '2025-03-22 01:07:24.8200000', '2025-03-22 01:07:24.8200000', '2025-03-22 01:07:24.8200000')
('CI612', '2025-03-25 09:15:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-25 12:23:42.4700000', 'delayed', 'B789', Decimal('10424.00'), 'https://example.com/book/CI612', '2025-03-22 01:06:54.1466667', '2025-03-22 01:06:54.1466667', '2025-03-22 01:06:54.1466667')
('CI765', '2025-03-25 09:45:00.0000000', 'CI', 'TPE', 'HKG', '2025-03-25 13:49:15.3333333', 'delayed', 'B789', Decimal('6563.00'), 'https://example.com/book/CI765', '2025-03-22 01:06:54.0333333', '2025-03-22 01:06:54.0333333', '2025-03-22 01:06:54.0266667')
('CX350', '2025-03-22 13:15:00.0000000', 'CX', 'TPE', 'HKG', '2025-03-22 19:13:20.2066667', 'on_time', 'A320', Decimal('13698.00'), 'https://example.com/book/CX350', '2025-03-22 11:39:38.9333333', '2025-03-22 11:39:38.9333333', '2025-03-22 11:39:38.9200000')
('JX111', '2025-03-26 17:15:00.0000000', 'JX', 'TPE', 'HKG', '2025-03-26 20:44:55.6066667', 'departed', 'B77W', Decimal('2734.00'), 'https://example.com/book/JX111', '2025-03-22 01:07:11.8266667', '2025-03-22 01:07:11.8266667', '2025-03-22 01:07:11.8266667')
('JX210', '2025-03-22 06:30:00.0000000', 'JX', 'TPE', 'HKG', '2025-03-22 12:14:54.3500000', 'on_time', 'B789', Decimal('10324.00'), 'https://example.com/book/JX210', '2025-03-22 00:51:43.2466667', '2025-03-22 00:51:43.2466667', '2025-03-22 00:51:43.2500000')
('JX517', '2025-03-22 22:15:00.0000000', 'JX', 'TPE', 'HKG', '2025-03-23 01:10:34.6566667', 'on_time', 'A333', Decimal('4729.00'), 'https://example.com/book/JX517', '2025-03-22 07:35:11.1200000', '2025-03-22 07:35:11.1200000', '2025-03-22 07:35:11.0866667')
('JX834', '2025-03-23 08:15:00.0000000', 'JX', 'TPE', 'HKG', '2025-03-23 14:06:36.4533333', 'on_time', 'B738', Decimal('6494.00'), 'https://example.com/book/JX834', '2025-03-22 00:52:21.4100000', '2025-03-22 00:52:21.4100000', '2025-03-22 00:52:21.4200000')
資料庫連接已關閉
檢查完成！
