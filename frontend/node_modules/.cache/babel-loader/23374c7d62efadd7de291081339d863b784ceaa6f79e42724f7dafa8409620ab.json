{"ast":null,"code":"import FlightCard from './FlightCard.vue';\nimport { getAirports, getAirlines, searchFlights } from '../services/api';\nexport default {\n  name: 'FlightSearch',\n  components: {\n    FlightCard\n  },\n  data() {\n    return {\n      departureAirport: '',\n      destinationAirport: '',\n      flightDate: this.getTodayDate(),\n      selectedAirline: '',\n      airports: [],\n      airlines: [],\n      filteredDestinations: [],\n      flights: [],\n      isLoading: false,\n      searchComplete: false,\n      errorMessage: ''\n    };\n  },\n  computed: {\n    minDate() {\n      // 設定最小日期為今天\n      return this.getTodayDate();\n    },\n    maxDate() {\n      // 設定最大日期為一年後\n      const date = new Date();\n      date.setFullYear(date.getFullYear() + 1);\n      return date.toISOString().split('T')[0];\n    },\n    canSearch() {\n      return this.departureAirport && this.destinationAirport && this.flightDate;\n    }\n  },\n  async mounted() {\n    await this.fetchInitialData();\n  },\n  methods: {\n    async fetchInitialData() {\n      try {\n        // 從API獲取機場和航空公司資料\n        const [airportsData, airlinesData] = await Promise.all([getAirports(), getAirlines()]);\n        this.airports = airportsData;\n        this.airlines = airlinesData;\n      } catch (error) {\n        console.error('無法載入初始資料:', error);\n        this.errorMessage = '無法載入資料，請稍後再試';\n      }\n    },\n    filterDestinations() {\n      if (!this.departureAirport) {\n        this.filteredDestinations = [];\n        this.destinationAirport = '';\n        return;\n      }\n\n      // 篩選所有與出發機場不同的機場\n      this.filteredDestinations = this.airports.filter(airport => airport.code !== this.departureAirport);\n    },\n    async searchFlights() {\n      this.isLoading = true;\n      this.searchComplete = true;\n      this.errorMessage = '';\n      try {\n        // 調用API搜尋航班\n        const results = await searchFlights({\n          departureAirport: this.departureAirport,\n          destinationAirport: this.destinationAirport,\n          date: this.flightDate,\n          airline: this.selectedAirline\n        });\n        this.flights = results;\n      } catch (error) {\n        console.error('搜尋航班時出錯:', error);\n        this.errorMessage = '搜尋過程中發生錯誤，請稍後再試';\n        this.flights = [];\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    resetForm() {\n      this.departureAirport = '';\n      this.destinationAirport = '';\n      this.flightDate = this.getTodayDate();\n      this.selectedAirline = '';\n      this.flights = [];\n      this.searchComplete = false;\n    },\n    getTodayDate() {\n      return new Date().toISOString().split('T')[0];\n    },\n    getAirportName(code) {\n      const airport = this.airports.find(a => a.code === code);\n      return airport ? airport.name : code;\n    },\n    getAirlineName(id) {\n      const airline = this.airlines.find(a => a.id === id);\n      return airline ? airline.name : id;\n    },\n    formatDateTime(dateTimeStr) {\n      const date = new Date(dateTimeStr);\n      return `${date.toLocaleDateString()} ${date.toLocaleTimeString([], {\n        hour: '2-digit',\n        minute: '2-digit'\n      })}`;\n    }\n  }\n};","map":{"version":3,"names":["FlightCard","getAirports","getAirlines","searchFlights","name","components","data","departureAirport","destinationAirport","flightDate","getTodayDate","selectedAirline","airports","airlines","filteredDestinations","flights","isLoading","searchComplete","errorMessage","computed","minDate","maxDate","date","Date","setFullYear","getFullYear","toISOString","split","canSearch","mounted","fetchInitialData","methods","airportsData","airlinesData","Promise","all","error","console","filterDestinations","filter","airport","code","results","airline","resetForm","getAirportName","find","a","getAirlineName","id","formatDateTime","dateTimeStr","toLocaleDateString","toLocaleTimeString","hour","minute"],"sources":["C:\\Users\\Aliothouo\\OneDrive\\文件\\學校\\AlphaVision\\AerotwineX\\frontend\\src\\components\\FlightSearch.vue"],"sourcesContent":["<template>\n  <div class=\"flight-search\">\n    <div class=\"header\">\n      <h1>AerotwineX 航班查詢</h1>\n      <p>簡單、快速地查詢您的航班</p>\n    </div>\n    \n    <div class=\"search-container\">\n      <div class=\"search-form\">\n        <div class=\"form-group\">\n          <label>出發地</label>\n          <select v-model=\"departureAirport\" @change=\"filterDestinations\">\n            <option value=\"\">請選擇出發機場</option>\n            <option v-for=\"airport in airports\" :key=\"airport.code\" :value=\"airport.code\">\n              {{ airport.name }} ({{ airport.code }})\n            </option>\n          </select>\n        </div>\n        \n        <div class=\"form-group\">\n          <label>目的地</label>\n          <select v-model=\"destinationAirport\" :disabled=\"!departureAirport\">\n            <option value=\"\">請選擇目的機場</option>\n            <option v-for=\"airport in filteredDestinations\" :key=\"airport.code\" :value=\"airport.code\">\n              {{ airport.name }} ({{ airport.code }})\n            </option>\n          </select>\n        </div>\n        \n        <div class=\"form-group\">\n          <label>日期</label>\n          <input type=\"date\" v-model=\"flightDate\" :min=\"minDate\" :max=\"maxDate\">\n        </div>\n        \n        <div class=\"form-group\">\n          <label>航空公司</label>\n          <select v-model=\"selectedAirline\">\n            <option value=\"\">所有航空公司</option>\n            <option v-for=\"airline in airlines\" :key=\"airline.id\" :value=\"airline.id\">\n              {{ airline.name }}\n            </option>\n          </select>\n        </div>\n        \n        <div class=\"action-buttons\">\n          <button class=\"search-button\" @click=\"searchFlights\" :disabled=\"!canSearch\">\n            搜尋航班\n          </button>\n          <button class=\"reset-button\" @click=\"resetForm\">\n            重設\n          </button>\n        </div>\n        \n        <div v-if=\"errorMessage\" class=\"error-message\">\n          {{ errorMessage }}\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"search-results\" v-if=\"searchComplete\">\n      <div v-if=\"isLoading\" class=\"loading\">\n        <div class=\"loader\"></div>\n        <p>搜尋中，請稍候...</p>\n      </div>\n      \n      <div v-else>\n        <div class=\"results-header\">\n          <h2>搜尋結果</h2>\n          <p v-if=\"flights.length === 0\">沒有找到符合條件的航班</p>\n          <p v-else>找到 {{ flights.length }} 個符合條件的航班</p>\n        </div>\n        \n        <div class=\"flights-container\" v-if=\"flights.length > 0\">\n          <flight-card \n            v-for=\"flight in flights\" \n            :key=\"`${flight.flight_number}-${flight.scheduled_departure}`\" \n            :flight=\"flight\"\n            :departureAirportName=\"getAirportName(flight.departure_airport_code)\"\n            :arrivalAirportName=\"getAirportName(flight.arrival_airport_code)\"\n            :airlineName=\"getAirlineName(flight.airline_id)\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport FlightCard from './FlightCard.vue';\nimport { getAirports, getAirlines, searchFlights } from '../services/api';\n\nexport default {\n  name: 'FlightSearch',\n  components: {\n    FlightCard\n  },\n  data() {\n    return {\n      departureAirport: '',\n      destinationAirport: '',\n      flightDate: this.getTodayDate(),\n      selectedAirline: '',\n      airports: [],\n      airlines: [],\n      filteredDestinations: [],\n      flights: [],\n      isLoading: false,\n      searchComplete: false,\n      errorMessage: ''\n    };\n  },\n  computed: {\n    minDate() {\n      // 設定最小日期為今天\n      return this.getTodayDate();\n    },\n    maxDate() {\n      // 設定最大日期為一年後\n      const date = new Date();\n      date.setFullYear(date.getFullYear() + 1);\n      return date.toISOString().split('T')[0];\n    },\n    canSearch() {\n      return this.departureAirport && this.destinationAirport && this.flightDate;\n    }\n  },\n  async mounted() {\n    await this.fetchInitialData();\n  },\n  methods: {\n    async fetchInitialData() {\n      try {\n        // 從API獲取機場和航空公司資料\n        const [airportsData, airlinesData] = await Promise.all([\n          getAirports(),\n          getAirlines()\n        ]);\n        \n        this.airports = airportsData;\n        this.airlines = airlinesData;\n      } catch (error) {\n        console.error('無法載入初始資料:', error);\n        this.errorMessage = '無法載入資料，請稍後再試';\n      }\n    },\n    \n    filterDestinations() {\n      if (!this.departureAirport) {\n        this.filteredDestinations = [];\n        this.destinationAirport = '';\n        return;\n      }\n      \n      // 篩選所有與出發機場不同的機場\n      this.filteredDestinations = this.airports.filter(\n        airport => airport.code !== this.departureAirport\n      );\n    },\n    async searchFlights() {\n      this.isLoading = true;\n      this.searchComplete = true;\n      this.errorMessage = '';\n      \n      try {\n        // 調用API搜尋航班\n        const results = await searchFlights({\n          departureAirport: this.departureAirport,\n          destinationAirport: this.destinationAirport,\n          date: this.flightDate,\n          airline: this.selectedAirline\n        });\n        \n        this.flights = results;\n      } catch (error) {\n        console.error('搜尋航班時出錯:', error);\n        this.errorMessage = '搜尋過程中發生錯誤，請稍後再試';\n        this.flights = [];\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    resetForm() {\n      this.departureAirport = '';\n      this.destinationAirport = '';\n      this.flightDate = this.getTodayDate();\n      this.selectedAirline = '';\n      this.flights = [];\n      this.searchComplete = false;\n    },\n    getTodayDate() {\n      return new Date().toISOString().split('T')[0];\n    },\n    getAirportName(code) {\n      const airport = this.airports.find(a => a.code === code);\n      return airport ? airport.name : code;\n    },\n    getAirlineName(id) {\n      const airline = this.airlines.find(a => a.id === id);\n      return airline ? airline.name : id;\n    },\n    formatDateTime(dateTimeStr) {\n      const date = new Date(dateTimeStr);\n      return `${date.toLocaleDateString()} ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.flight-search {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 2rem;\n  color: #333;\n  font-family: 'Arial', sans-serif;\n}\n\n.header {\n  text-align: center;\n  margin-bottom: 2rem;\n}\n\n.header h1 {\n  font-size: 2.5rem;\n  margin-bottom: 0.5rem;\n  font-weight: 300;\n  letter-spacing: 1px;\n}\n\n.header p {\n  font-size: 1.2rem;\n  color: #666;\n}\n\n.search-container {\n  background-color: #f8f8f8;\n  border-radius: 8px;\n  padding: 2rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  margin-bottom: 2rem;\n}\n\n.search-form {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1.5rem;\n}\n\n.form-group {\n  display: flex;\n  flex-direction: column;\n}\n\nlabel {\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: #555;\n}\n\nselect, input {\n  padding: 0.8rem;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 1rem;\n  background-color: white;\n  transition: border-color 0.3s;\n}\n\nselect:focus, input:focus {\n  border-color: #333;\n  outline: none;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 1rem;\n  margin-top: 1.5rem;\n  grid-column: 1 / -1;\n}\n\nbutton {\n  padding: 0.8rem 1.5rem;\n  border: none;\n  border-radius: 4px;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: background-color 0.3s, transform 0.1s;\n}\n\nbutton:hover {\n  transform: translateY(-2px);\n}\n\n.search-button {\n  background-color: #333;\n  color: white;\n  flex: 2;\n}\n\n.search-button:hover {\n  background-color: #222;\n}\n\n.search-button:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.reset-button {\n  background-color: #e6e6e6;\n  color: #333;\n  flex: 1;\n}\n\n.reset-button:hover {\n  background-color: #d9d9d9;\n}\n\n.error-message {\n  color: #d32f2f;\n  background-color: #ffebee;\n  padding: 0.8rem;\n  border-radius: 4px;\n  margin-top: 1rem;\n  text-align: center;\n  font-weight: 500;\n  grid-column: 1 / -1;\n}\n\n.search-results {\n  margin-top: 2rem;\n}\n\n.results-header {\n  text-align: center;\n  margin-bottom: 1.5rem;\n}\n\n.results-header h2 {\n  font-size: 1.8rem;\n  font-weight: 300;\n  margin-bottom: 0.5rem;\n}\n\n.loading {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 3rem 0;\n}\n\n.loader {\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #333;\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.flights-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 1.5rem;\n}\n\n@media (max-width: 768px) {\n  .search-form {\n    grid-template-columns: 1fr;\n  }\n  \n  .flights-container {\n    grid-template-columns: 1fr;\n  }\n  \n  .flight-search {\n    padding: 1rem;\n  }\n}\n</style>"],"mappings":"AAwFA,OAAOA,UAAS,MAAO,kBAAkB;AACzC,SAASC,WAAW,EAAEC,WAAW,EAAEC,aAAY,QAAS,iBAAiB;AAEzE,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IACVL;EACF,CAAC;EACDM,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,gBAAgB,EAAE,EAAE;MACpBC,kBAAkB,EAAE,EAAE;MACtBC,UAAU,EAAE,IAAI,CAACC,YAAY,CAAC,CAAC;MAC/BC,eAAe,EAAE,EAAE;MACnBC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,oBAAoB,EAAE,EAAE;MACxBC,OAAO,EAAE,EAAE;MACXC,SAAS,EAAE,KAAK;MAChBC,cAAc,EAAE,KAAK;MACrBC,YAAY,EAAE;IAChB,CAAC;EACH,CAAC;EACDC,QAAQ,EAAE;IACRC,OAAOA,CAAA,EAAG;MACR;MACA,OAAO,IAAI,CAACV,YAAY,CAAC,CAAC;IAC5B,CAAC;IACDW,OAAOA,CAAA,EAAG;MACR;MACA,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAAC,CAAC;MACvBD,IAAI,CAACE,WAAW,CAACF,IAAI,CAACG,WAAW,CAAC,IAAI,CAAC,CAAC;MACxC,OAAOH,IAAI,CAACI,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACzC,CAAC;IACDC,SAASA,CAAA,EAAG;MACV,OAAO,IAAI,CAACrB,gBAAe,IAAK,IAAI,CAACC,kBAAiB,IAAK,IAAI,CAACC,UAAU;IAC5E;EACF,CAAC;EACD,MAAMoB,OAAOA,CAAA,EAAG;IACd,MAAM,IAAI,CAACC,gBAAgB,CAAC,CAAC;EAC/B,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,gBAAgBA,CAAA,EAAG;MACvB,IAAI;QACF;QACA,MAAM,CAACE,YAAY,EAAEC,YAAY,IAAI,MAAMC,OAAO,CAACC,GAAG,CAAC,CACrDlC,WAAW,CAAC,CAAC,EACbC,WAAW,CAAC,EACb,CAAC;QAEF,IAAI,CAACU,QAAO,GAAIoB,YAAY;QAC5B,IAAI,CAACnB,QAAO,GAAIoB,YAAY;MAC9B,EAAE,OAAOG,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,WAAW,EAAEA,KAAK,CAAC;QACjC,IAAI,CAAClB,YAAW,GAAI,cAAc;MACpC;IACF,CAAC;IAEDoB,kBAAkBA,CAAA,EAAG;MACnB,IAAI,CAAC,IAAI,CAAC/B,gBAAgB,EAAE;QAC1B,IAAI,CAACO,oBAAmB,GAAI,EAAE;QAC9B,IAAI,CAACN,kBAAiB,GAAI,EAAE;QAC5B;MACF;;MAEA;MACA,IAAI,CAACM,oBAAmB,GAAI,IAAI,CAACF,QAAQ,CAAC2B,MAAM,CAC9CC,OAAM,IAAKA,OAAO,CAACC,IAAG,KAAM,IAAI,CAAClC,gBACnC,CAAC;IACH,CAAC;IACD,MAAMJ,aAAaA,CAAA,EAAG;MACpB,IAAI,CAACa,SAAQ,GAAI,IAAI;MACrB,IAAI,CAACC,cAAa,GAAI,IAAI;MAC1B,IAAI,CAACC,YAAW,GAAI,EAAE;MAEtB,IAAI;QACF;QACA,MAAMwB,OAAM,GAAI,MAAMvC,aAAa,CAAC;UAClCI,gBAAgB,EAAE,IAAI,CAACA,gBAAgB;UACvCC,kBAAkB,EAAE,IAAI,CAACA,kBAAkB;UAC3Cc,IAAI,EAAE,IAAI,CAACb,UAAU;UACrBkC,OAAO,EAAE,IAAI,CAAChC;QAChB,CAAC,CAAC;QAEF,IAAI,CAACI,OAAM,GAAI2B,OAAO;MACxB,EAAE,OAAON,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;QAChC,IAAI,CAAClB,YAAW,GAAI,iBAAiB;QACrC,IAAI,CAACH,OAAM,GAAI,EAAE;MACnB,UAAU;QACR,IAAI,CAACC,SAAQ,GAAI,KAAK;MACxB;IACF,CAAC;IACD4B,SAASA,CAAA,EAAG;MACV,IAAI,CAACrC,gBAAe,GAAI,EAAE;MAC1B,IAAI,CAACC,kBAAiB,GAAI,EAAE;MAC5B,IAAI,CAACC,UAAS,GAAI,IAAI,CAACC,YAAY,CAAC,CAAC;MACrC,IAAI,CAACC,eAAc,GAAI,EAAE;MACzB,IAAI,CAACI,OAAM,GAAI,EAAE;MACjB,IAAI,CAACE,cAAa,GAAI,KAAK;IAC7B,CAAC;IACDP,YAAYA,CAAA,EAAG;MACb,OAAO,IAAIa,IAAI,CAAC,CAAC,CAACG,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAC/C,CAAC;IACDkB,cAAcA,CAACJ,IAAI,EAAE;MACnB,MAAMD,OAAM,GAAI,IAAI,CAAC5B,QAAQ,CAACkC,IAAI,CAACC,CAAA,IAAKA,CAAC,CAACN,IAAG,KAAMA,IAAI,CAAC;MACxD,OAAOD,OAAM,GAAIA,OAAO,CAACpC,IAAG,GAAIqC,IAAI;IACtC,CAAC;IACDO,cAAcA,CAACC,EAAE,EAAE;MACjB,MAAMN,OAAM,GAAI,IAAI,CAAC9B,QAAQ,CAACiC,IAAI,CAACC,CAAA,IAAKA,CAAC,CAACE,EAAC,KAAMA,EAAE,CAAC;MACpD,OAAON,OAAM,GAAIA,OAAO,CAACvC,IAAG,GAAI6C,EAAE;IACpC,CAAC;IACDC,cAAcA,CAACC,WAAW,EAAE;MAC1B,MAAM7B,IAAG,GAAI,IAAIC,IAAI,CAAC4B,WAAW,CAAC;MAClC,OAAO,GAAG7B,IAAI,CAAC8B,kBAAkB,CAAC,CAAC,IAAI9B,IAAI,CAAC+B,kBAAkB,CAAC,EAAE,EAAE;QAAEC,IAAI,EAAE,SAAS;QAAEC,MAAM,EAAE;MAAU,CAAC,CAAC,EAAE;IAC9G;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}